dplyr::select(x,y,group, pollutant, emissions) %>%
spread(pollutant, emissions) %>%
rename_all(tolower) %>%
mutate(no2 = nox * 0.05,
year = 2016)
write_csv(result, 'results/shipping_emissions_20m.csv')
rm(result)
# Output large grid in desired format
result <- grid_emissions %>%
st_drop_geometry() %>%
mutate(emissions = sailing + berth) %>%
dplyr::select(pollutant, large_grid_id, emissions) %>%
group_by(pollutant, large_grid_id) %>%
summarise(emissions = sum(emissions, na.rm=T)) %>%
spread(pollutant, emissions) %>%
rename_all(tolower) %>%
mutate(no2 = nox * 0.05,
year = 2016)
write_csv(result, 'results/shipping_emissions_1km.csv')
rm(result)
rm(list=ls(all=TRUE))
library(sf)
library(tidyverse)
library(scales)
library(snowfall)
library(fasterize)
library(raster)
latlong = "+init=epsg:4326"
ukgrid  = "+init=epsg:27700"
google  = "+init=epsg:3857"
the_thames <- st_read('https://raw.githubusercontent.com/KCL-ERG/useful_geography/master/thames.geojson')
## Import the ship classifications
vessel_class              <- read_csv('docs/vessel_classifications.csv')
vessel_class$code         <- as.character(vessel_class$code)
# Get emissions by exact cut, substance and vessel type
emissions                 <- read_csv('emissions/inventory_export_2016.csv', col_types = cols())
emissions                 <- emissions[emissions$LAEIPLAExt == 'LAEI',]
emissions                 <- emissions[,c('VesselType', 'Substance', 'CellID', 'Sailing_kg', 'AtBerth_kg')]
emissions$CellID          <- as.numeric(emissions$CellID)
names(emissions)          <- c('ship_type', 'pollutant', 'cellid', 'sailing', 'berth')
pollutants_we_want        <- c('PM', 'PM2.5', 'NOx')
emissions                 <- emissions[emissions$pollutant %in% pollutants_we_want,]
rm(pollutants_we_want)
# Tidy up some of the vessel classifications in the emissions file to match the GPS ecssel types
emissions[emissions$ship_type == 'RoRo Cargo / Vehicle','ship_type'] <-'RoRo Cargo/Vehicle'
emissions[emissions$ship_type == 'Cruise ship','ship_type']          <-'Passenger (cruise)'
emissions[emissions$ship_type == 'Passenger', 'ship_type']           <-'Passenger (ferry)'
# Add vessel group type to the emissions, for matching with GPS data
emissions                 <- left_join(emissions, unique(vessel_class[,c('aggregated_class', 'group')]),
by = c('ship_type' = 'aggregated_class'))
# Now aggregte
emissions <- emissions %>%
dplyr::select(-ship_type) %>%
group_by(pollutant, cellid, group) %>%
summarise(sailing = sum(sailing, na.rm=T),
berth   = sum(berth, na.rm=T)) %>%
ungroup()
# Now get the grid by exact cut
grid                      <- st_read('grids/LAEIGridExtensionV2.gpkg', quiet = T)
# Link grid exact cut to eimssions exact cut, and remove some unncecessary data
grid_emissions            <- left_join(emissions, grid, by = c('cellid' = 'CellID')) %>%
rename(large_grid_id = GRID_ID0, x = X_COORD, y = Y_COORD) %>%
dplyr::select(cellid, large_grid_id, x, y, pollutant, group, sailing, berth) %>%
as.tibble() %>%
group_by(pollutant, group, large_grid_id, x, y) %>%
summarise(sailing = sum(sailing), berth = sum(berth)) %>%
st_as_sf(coords = c("x", "y"), crs=27700) %>%
st_buffer(dist = 500, endCapStyle= "SQUARE")
rm(emissions, grid)
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = sailing)) +
scale_fill_distiller(palette = 'RdYlGn') +
ggtitle('Sailing emissions: NOx group 1')
ggsave('large_grid_sailing_group_one_nox.png', plot = plot, path = 'maps/', height = 5, width = 15, units='cm')
rm(plot)
vessel_class
filter(vessel_class, group == 1)
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = sailing)) +
scale_fill_discrete(palette = 'RdYlGn')
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = as.factor(sailing))) +
scale_fill_discrete(palette = 'RdYlGn')
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = as.Factor(sailing))) +
scale_fill_discrete(palette = 'RdYlGn')
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = sailing))
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% select(sailing)
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% dplyr::select(sailing)
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% dplyr::select(sailing)$sailing
hist(filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% dplyr::select(sailing))
ggplot(filter(grid_emissions, pollutant == 'NOx' & group == 1), aes(x = sailing)) + geom_histogram()
filter(grid_emissions, pollutant == 'NOx' & group == 1)
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% as_tibble()
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% st_drop_geometry() %>% select(sailing)
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% st_drop_geometry() %>% dplyr::select(sailing)
quantile(filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% st_drop_geometry() %>% dplyr::select(sailing),0,1)
quantile(filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% st_drop_geometry() %>% dplyr::select(sailing) %>% as.vector(),0,1)
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% st_drop_geometry() %>% dplyr::select(sailing) %>% as.vector()
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% st_drop_geometry() %>% dplyr::select(sailing) %>% quantile(., 0.3)
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% st_drop_geometry() %>% dplyr::select(sailing) %>% quantile(.$sailing, 0.3)
sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% st_drop_geometry() %>% dplyr::select(sailing)
quantile(sailing$sailing,0.3)
quantile(sailing$sailing,seq(0,1,0,2)
_
quantile(sailing$sailing,1:10
quantile(sailing$sailing,1:10)
quantile(sailing$sailing,c(0,0.1))
seq(0,1,0.2)
quantile(sailing$sailing,seq(0,1,0.2))
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = sailing)) +
scale_fill_distiller(palette = 'RdYlGn', breaks = quantile(sailing$sailing,seq(0,1,0.2))) +
ggtitle('NOx passenger ferry sailing emissions')
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = sailing)) +
scale_color_manual(breaks = quantile(sailing$sailing,seq(0,1,0.2)))
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = as.factor(sailing))) +
scale_color_manual(breaks = quantile(sailing$sailing,seq(0,1,0.2)))
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = NA, aes(fill = as.factor(sailing))) +
scale_color_manual(values = quantile(sailing$sailing,seq(0,1,0.2)))
filter(grid_emissions, pollutant == 'NOx' & group == 1)
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = 'black', aes(fill = as.factor(sailing))) +
scale_color_manual(values = quantile(sailing$sailing,seq(0,1,0.2))) +
ggtitle('NOx passenger ferry sailing emissions')
filter(grid_emissions, pollutant == 'NOx' & group == 1) %>%
cut(sailing,
breaks=quantile(sailing,seq(0,1,0.2)))
nox_group_one <- filter(grid_emissions, pollutant == 'NOx' & group == 1)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% select(sailing)
cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)))
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% dplyr::select(sailing)
cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)))
cut(nox_group_one_sailing$sailing,
breaks=round(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),2))
as.numeric(cut(nox_group_one_sailing$sailing,
breaks=round(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),2)))
format(cut(nox_group_one_sailing$sailing,
breaks=round(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),2))
)
format(cut(nox_group_one_sailing$sailing,
breaks=round(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),2)), scientific=F)
format(cut(nox_group_one_sailing$sailing,
breaks=round(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),2)), scientific=FALSE)
as.numeric(cut(nox_group_one_sailing$sailing,
breaks=round(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),2)))
cut(nox_group_one_sailing$sailing,
breaks=round(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),2))
format(cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))), scientific=FALSE)
cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)))
cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),
labels=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)))
cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),
labels=c(1,2,3,4,5))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[1]
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[1,1]
paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[1], quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[2])
paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[1], quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[2], '-')
paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[1], '-', quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[2],)
paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[1], '-', quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[2])
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[(i+1)])
}
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[(i+1)])
}
labels
unlist(labels)
labels <-  unlist(labels)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing <- cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),
labels = labels)
nox_group_one_sailing
nox_group_one_sailing
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),
labels = labels)
head(nox_group_one_sailing)
ggplot() +
geom_sf(data = filter(grid_emissions, pollutant == 'NOx' & group == 1), colour = 'black', aes(fill = sailing)) +
scale_color_manual(breaks = emissions)
ggplot() +
geom_sf(data = nox_group_one_sailing, colour = 'black', aes(fill = sailing)) +
scale_color_manual(breaks = emissions)
head(nox_group_one_sailing)
ggplot() +
geom_sf(data = nox_group_one_sailing, colour = 'black', aes(fill = sailing))
ggplot() +
geom_sf(data = nox_group_one_sailing, colour = 'black', aes(fill = sailing)) +
scale_color_manual(values = sailing, breaks = emissions)
nox_group_one_sailing
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions))
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
scale_color_manual(values = sailing, breaks = emissions) +
coord_equal()
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) + coord_equal()
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) + coord_sf()
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) + coord_sf(crs = 27700)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),
labels = labels)
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) + coord_sf(crs = 27700)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.2)),
labels = labels)
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) + coord_sf(crs = 27700)
filter(nox_group_one_sailing, is.na(emissions))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,01))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.1)),
labels = labels)
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) + coord_sf(crs = 27700)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,01))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.1)),
labels = labels)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.1)),
labels = labels)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:10) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.1)),
labels = labels)
nox_group_one_sailing
filter(nox_group_one_sailing, is.na(emissions))
filter(nox_group_one_sailing, is.na(emissions))
cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.1)),
labels = labels)
cut(nox_group_one_sailing$sailing,
breaks=quantile(nox_group_one_sailing$sailing,seq(0,1,0.1)))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))
quantile(nox_group_one_sailing$sailing,seq(0.005,1,0.1))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[2:10]
c(0,quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[2:10])
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:10) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=c(0,quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[2:10]),
labels = labels)
length(c(0,quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[2:10]))
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=c(0,quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[2:10]),
labels = labels)
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) + coord_sf(crs = 27700)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.05))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.05))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=c(0,quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[2:10]),
labels = labels)
nox_group_one_sailing <- filter(grid_emissions, pollutant == 'NOx' & group == 1 & !is.na(sailing)) %>% dplyr::select(sailing)
labels <-  list()
for (i in 1:5) {
labels[[i]] <- paste(quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[i],
'-',
quantile(nox_group_one_sailing$sailing,seq(0,1,0.1))[(i+1)])
}
labels <-  unlist(labels)
nox_group_one_sailing$emissions <- cut(nox_group_one_sailing$sailing,
breaks=c(0,quantile(nox_group_one_sailing$sailing,seq(0,1,0.2))[2:10]),
labels = labels)
now_group_one_sa
now_group_one_sailing
nox_group_one_sailing
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
theme(panel.grid = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
theme(panel.grid = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf(default = F, crs = 27700)
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf(default = F, crs = ukgrid)
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf()
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
theme(axis.text = F)
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
theme(axis.text = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
theme(axis.text = element_blank(),
axis.ticks = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(name = "Emissions ug/m3") +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(name = "NOx Emissions ug/m3") +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank()) +
ylab (expression(paste(
"Surface area concentration (",
mu, m^2, "/", m^3,
")", sep="")))
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(name = "NOx Emissions ug/m3") +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank()) +
ylab (expression(paste("Surface area concentration (", mu, m^2, "/", m^3, ")", sep="")))
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(name = "NOx emissions (kg/year)") +
#scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
1+1
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(name = "NOx emissions (kg/year)", palette = "Spectral") +
#scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(name = "NOx emissions (kg/year)") +
#scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(values = colours, name = "NOx emissions (kg/year)") +
#scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(colours = colours, name = "NOx emissions (kg/year)") +
#scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
colours <- c('#ffffd4','#fed98e','#fe9929','#d95f0e','#993404')
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_discrete(values = colours, name = "NOx emissions (kg/year)") +
#scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_colour_manual(values = colours, name = "NOx emissions (kg/year)") +
#scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
colours
ggplot(data = nox_group_one_sailing) +
geom_sf(colour = 'black', aes(fill = emissions)) +
coord_sf() +
scale_fill_manual(values = colours, name = "NOx emissions (kg/year)") +
#scale_fill_discrete(name = expression(paste("NOx emissions (", mu, m^2, "/", m^3, ")", sep=""))) +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
panel.background = element_blank())
nox_group_one_sailing
labels
